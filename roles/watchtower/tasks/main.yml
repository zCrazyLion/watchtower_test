---
- name: Start Watchtower container
  community.docker.docker_container:
    name: watchtower
    state: "{{ container_state }}"
    image: containrrr/watchtower:latest
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    env:
      WATCHTOWER_POLL_INTERVAL: "{{ watchtower_poll_interval }}"
      WATCHTOWER_CLEANUP: "{{ watchtower_cleanup }}"
      WATCHTOWER_LABEL_ENABLE: "{{ watchtower_label_enable }}"
      WATCHTOWER_DEBUG: "{{ watchtower_debug }}"
    restart_policy: always